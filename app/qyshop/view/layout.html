<!-- head -->
{include file="./_layout/header" /}
<style>
	.menu-cell {
		width: 8%;
		height: 100%;
		color: #ffffff;
		text-align: center;
		float: left;
	}

	.menu-cell span {
		border-top: 4px #2D8CC1 solid;
		border-bottom: 4px #2D8CC1 solid;
		line-height: 40px;
		padding: 7px 0;
		width: 80%;
	}

	.menu-cell.active span {
		border-bottom: 4px #ffffff solid;
	}

	.menu-line {
		width: 1px;
		height: 20px;
		margin: 10px 0;
		border-right: 1px #fff solid;
		float: left;
	}

	#side-menu li{
		background-color: #2377AF;
		border-bottom: 1px #468FB7 solid;
		text-align: center;
	}

	#side-menu li a {
		color: #ffffff;
	}

	.form-group.has-error em {
		color: #b94a48;
	}

	td.bs-checkbox {
		text-align: center;
	}
</style>
<script>
	var GetUrl = [];
	var GetList = [];
	var listContent = '';
	var URL;
	var ActiveMenu;

	var HREF = window.location.href;
	var i = HREF.indexOf("#");
	var STR = HREF.substring(i+1);

	var content ={};

	{foreach $menus as $menu}
	{if condition='$menu.display eq 1'}
	listContent = '';
	content['{$menu.title}'] = [];
	{if condition='isset($menu.children)'}
	{foreach $menu.children as $children}
	{if condition='$children.display eq 1'}
	GetUrl.push(['{$children.rule_val}','{$menu.rule_val}']);
	listContent = listContent + "<li><a href='/"+ '{$children.rule_val}' +"'>" + '{$children.title}' + "</a></li>";
	//content['{$menu.title}'].push({title:'{$children.title}',url:'{$children.rule_val}'});
	{/if}
	{/foreach}
	GetList.push(['{$menu.rule_val}',listContent]);
	{/if}
	{/if}
	{/foreach}
	GetUrl.push(["qyshop/shop/index","shopManage"],["qyshop/production/index","shopManage"],["qyshop/cart/index","shopManage"],["qyshop/cart/settlelist","shopManage"],["qyshop/user/index","userInfo"]);
	GetList.push(["shopManage","<li><a href='/qyshop/shop/index'>店铺管理</a></li><li><a href='/qyshop/production/index'>商品管理</a></li><li><a href='/qyshop/cart/index'>订单管理</a></li><li><a href='/qyshop/cart/settlelist'>结算管理</a></li>"],["userInfo","<li><a href='/qyshop/user/index'>个人信息</a></li>"]);
	console.log(GetUrl);
</script>
<body class="smart-style-0 desktop-detected" style="background-color: #e6e6e6">
<header id="header" style="width: 100%; height: 100px; background-color: white; position: fixed; background-image: none; padding: 0; box-shadow: 0 3px 5px rgba(84,84,84,0.3)">
	<div style="width: 40%; height: 60px; display: table; margin: 0 0 0 5%;">
		<span class="m-r-sm text-muted welcome-message" style="display: table-cell; height: 100%; vertical-align: middle; font-size: 16px">{$shopName}</span>
	</div>
	<div style="width: 15%; height: 60px; display: table; margin: 0 5% 0 0; float: right;">
		<span class="m-r-sm text-muted welcome-message" style="display: table-cell; height: 100%; vertical-align: middle; padding: 0 5%;">{$username}</span>
			<span class="m-r-sm text-muted welcome-message" style="display: table-cell; height: 100%; vertical-align: middle; margin: 0 0 0 5%; padding: 0 5%;">
				<a href="{:url('Admin/Login/out');}">
					<i class="fa fa-sign-out"></i> 退出
				</a>
			</span>
	</div>
	<div style="clear: both;"></div>
	<div id="main_menu" style="width: 100%; height: 40px; background-color: #2D8CC1;">
		<div class="menu-cell" id="shopManage" onclick="checkActive(this)">
			<span>店铺管理</span>
		</div>
		<div class="menu-line"></div>
		<div class="menu-cell" id="userInfo" onclick="checkActive(this)">
			<span>个人信息管理</span>
		</div>
		<div class="menu-line"></div>
		<div style="clear: both"></div>
	</div>

</header>
<aside id="left-panel" style="padding-top: 100px; position: fixed; background-color: #2377AF; background-image: none">
	<nav class="navbar-default navbar-static-side" role="navigation">
		{include file="./_layout/sidebar" /}
	</nav>
</aside>

<div id="main" role="main" style="padding-bottom: 0; padding-top: 100px;;">
	<div>
		{__CONTENT__}
	</div>
</div>

<div class="page-footer" style="border: 0; padding-top: 0; height: 40px; position: fixed; bottom: 0;">
	{include file="./_layout/footer" /}
</div>

<script>

	function ShowSubmenu () {
		for ( var i = 0; i < GetUrl.length; i++) {
			if ( HREF.indexOf(GetUrl[i][0]) > 1 ) {
				ActiveMenu = GetUrl[i][1];
			}
		}

		for ( var j = 0; j < GetList.length; j ++) {
			if (GetList[j][0] == ActiveMenu) {
				$("#side-menu").append(GetList[j][1]);
			}
		}

		$("#"+ ActiveMenu+"").addClass('active');
	}

	var Title = "";
	var subtitle = "";

	function checkActive (e) {

		subtitle = "";

		if ( $(e).hasClass('active') ) {
			return false;
		} else {
			$(e).addClass('active');
			var ID = $(e).attr('id');
			$(e).siblings().removeClass('active');
			Title = $(e).children("span").html();
			$("#side-menu").empty();
			for ( var i=0; i<GetList.length; i++) {
				if ($.inArray(ID,GetList[i])>-1) {
					$("#side-menu").append(GetList[i][1]);
				}
			}
		}
	}

	window.onload = function() {
		ShowSubmenu();
	};
</script>
</body>
</html>